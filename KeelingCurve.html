<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="Author" content="Leslie Bondaryk" />
	<meta name="Owner" content="Pearson" />
	<meta name="Copyright" content="Copyright (c) 2013 Pearson. All rights reserved." />
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="Carmen Santiago, Demo Book" name="description" />

    <!-- Bootstrap -->
    <link href="css/bootstrap_plus.css" rel="stylesheet" media="screen">
	<link href="css/widgets.css" rel="stylesheet">
	<link href="css/learning-objective.css" rel="stylesheet">
	<link href="css/eCourse-master.css" rel="stylesheet" media="screen">
	<link href="css/grey-thing.css" rel="stylesheet">
	<title class="setTitle"></title>
</head>

<body>
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span4 leftCol">
            	<h2 class="setTitle"></h2>
              	<p> In 1958, a scientist from Scripps Institution of Oceanography in San Diego, CA, named Dave Keeling started measuring carbon dioxide in the atmosphere. He wanted a pollution-free sample so he went to the top of Mauna Loa in Hawaii. Every month he took a samples of the air. After only two years he noticed some interesting things about his data. The amount of CO2 in the air was highest in the spring (May) and lowest in the fall (October). He correctly reasoned that this Annual Cycle is due to plants on land.
              	</p>
				
				<p>Trees, and especially the leaves on trees, are made from carbon dioxide taken from the air. All spring, summer and fall, trees are making new leaves and pulling CO2 out of the atmosphere. In the fall, these leaves fall to the ground where they rot and the carbon in them is returned back to atmosphere. CO2 in the air goes down in the summer as the trees grow and then goes back up in the winter as the leaves rot. There are enough plants on land to change the total amount of CO2 in the air every year! </p>
				
				<p>The other thing that Keeling discovered was that there was more CO2 in the air each year than there was in the previous year:
					<div id="dates"></div></p>

				<p>This trend he found is still continuing, in fact, the yearly increase is getting larger â€“ it is twice as big today (2013) as it was when he started taking measurements 55 years ago.
				</p>
			</div>
			<div class="span8 rightCol">         
                <div id="graph0"></div> 
               		<table width="100%">
                    <tr><td colspan="2">
                	<span id="growthSlider"></span> </td></tr>
					<tr><td class="rightAlign"><span id="popDay"></span></td>
                    	<td class="rightAlign"><span id="pop2010"></span></td></tr>
                    <tr><td class="rightAlign"><span id="popWeek"></span></td>
                    	<td class="rightAlign"><span id="pop2050"></span></td></tr>
                    <tr><td class="rightAlign"><span id="popYear"></span></td></tr>
            		</table>
			</div>
		</div>
	</div>
	
	
    <script src="js/jquery-latest.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<!-- script src="js/jquery.touchSwipe.min.js"></script-->
	<script src="js/jquery-ui-1.10.2.custom.js"></script>
	<script src="js/toc-structure.js"></script>    
	<script src="js/eCourse-master.js"></script>    
	<script src="js/d3.v3.min.js"></script>

	<script src="js/widget-base.js"></script>
	<script src="js/widget-linegraph.js"></script>
    <script src="js/widget-slider.js"></script>
    <script src="js/widget-callouts.js"></script>
    <script src="js/widget-legend.js"></script>
    <script src="js/widget-numeric.js"></script>
    <script src="js/widget-markergroup.js"></script>
	<script src="js/eventmanager.js"></script>

	<script>



	//the eventManager is an object that is specific to this page.  A new one
	//is created for every page, and then passed to the widgets in that page
	//that must talk to it.
	var eventManager = new EventManager();
	 
	var iceFloe = [
	{x:	"8 1957"	, y:	306.78	},
	{x:	"10 1957"	, y:	311	},
	{x:	"11 1957"	, y:	314	},
	{x:	"1 1958"	, y:	316	}
	]; 
	
	var maunaLoa = [
	{x:	"03-1-1958", y:	313.7},
	{x:	"04-1-1958", y:	314	},
	{x:	"05-1-1958", y:	315	},
	{x:	"07-1-1958", y:	313	},
	{x:	"08-1-1958", y:	312	},
	{x:	"09-1-1958", y:	311	},
	{x:	"10-1-1958", y:	310.5},
	{x:	"11-1-1958", y:	310	},
	{x:	"12-1-1958", y:	311	},
	{x:	"01-1-1959", y:	312	},
	{x:	"02-1-1959", y:	312.5	},
	{x:	"03-1-1959", y:	313	},
	{x:	"04-1-1959", y:	314.7	},
	{x:	"05-1-1959", y:	315	},
	{x:	"06-1-1959", y:	314.8	},
	{x:	"07-1-1959", y:	313	},
	{x:	"08-1-1959", y:	311	},
	{x:	"09-1-1959", y:	310.5	},
	{x:	"10-1-1959", y:	310	},
	{x:	"11-1-1959", y:	311.5	},
	{x:	"12-1-1959", y:	313.2	},
	{x:	"01-1-1960", y:	313.8	},
	{x:	"02-1-1960", y:	314.2	},
	{x:	"03-1-1960", y:	315.7	},
	]; 


	var aircraftHigh = [
	{x:	"09-1-1958", y:	310 },
	{x:	"10-1-1958", y:	311	},
	{x:	"01-1-1959", y:	313	},
	{x:	"02-1-1959", y:	314	},
	{x:	"04-1-1959", y:	316.5	},
	{x:	"05-1-1959", y:	317.7	},
	{x:	"06-1-1959", y:	314	},
	{x:	"08-1-1959", y:	311	},
	{x:	"09-1-1959", y:	311.5	},
	{x:	"10-1-1959", y:	312	},
	{x:	"11-1-1959", y:	313	},
	{x:	"12-1-1959", y:	314	},
	{x:	"01-1-1960", y:	315	},
	{x:	"02-1-1960", y:	315	},

	]; 


	var aircraftLow = [
	{x:	"06-1-1959", y:	314	},
	{x:	"08-1-1959", y:	308	},
	{x:	"09-1-1959", y:	311	},
	{x:	"10-1-1959", y:	313	},
	{x:	"11-1-1959", y:	313.8},
	{x:	"12-1-1959", y:	315	},
	{x:	"01-1-1960", y:	317	},

	]; 
	
	var barrow = [
		{x: "1971-05"	, y:  332.19},
 		{x: "1971-06"	, y:  330.33},
		{x: "1971-07"	, y:  323.78},
 		{x: "1971-08"	, y:  317.71},
 		{x: "1971-09"	, y:  318.74},
 		{x: "1971-10"	, y:  322.79},
 		{x: "1971-11"	, y:  327.23},
 		{x: "1971-12"	, y:  331.05},
 		{x: "1972-01"	, y:  333.48},
 		{x: "1972-02"	, y:  334.11},
 		{x: "1972-03"	, y:  334.08},
 		{x: "1972-04"	, y:  334.5},
 		{x: "1972-05"	, y:  335.5},
 		{x: "1972-06"	, y: 333.51},
 		{x: "1972-07"	, y:  324.91},
 		{x: "1972-08"	, y:  318.77},
 		{x: "1972-09"	, y:  321.86},
 		{x: "1972-10"	, y:  327.09},
 		{x: "1972-11"	, y: 330.5},
 		{x: "1972-12"	, y: 333.37},
 		{x: "1973-01"	, y:  334.68},
 		{x: "1973-02"	, y:  335.32},
 		{x: "1973-03"	, y:  336.43},
 		{x: "1973-04"	, y:  336.95},
 		{x: "1973-05"	, y:  336.53},
 		{x: "1973-06"	, y:  334.27},
 		{x: "1973-07"	 , y:  327.85},
 		{x: "1973-08"	, y:  322.3},
 		{x: "1973-09"	, y:  323.48},

	];
	
	var Data = [iceFloe, maunaLoa, aircraftHigh, aircraftLow];
		
// draw the highlightable dates table
	var clickDates = new Callouts({
		show: "all",
		headers: ["Date", "CO<sub>2</sub> Concentration (ppm)" ],
		textBits: [
		{cols: [maunaLoa[0].x, maunaLoa[0].y]},
		{cols: [maunaLoa[11].x, maunaLoa[11].y]},
		{cols: [maunaLoa[23].x, maunaLoa[23].y]}
		]
	}, eventManager);
	
	clickDates.draw(d3.select("#dates"));
// configure and draw the SVG container and the graph of the co2 data

	var cont1 = new SVGContainer({
			node: d3.select("#graph0"),
			maxWid: 800,
			maxHt: 500
		});
		
	var lines = new LineGraph({
			id: "lg0",
			Data: Data, 
			type: "lines+points",
			xAxisFormat: { type: "ordinal",
						   ticks: 5,
						   orientation: "bottom",
						   label: "Year" },
			yAxisFormat: { type: "linear",
						   orientation: "left",
						   label: "CO<sub>2</sub> Concentration (ppm)",
						    ticks: [305,310,315,320,325],
						    },
		},eventManager);	
			
	cont1.append(lines, {topPercentOffset: 0.2, leftPercentOffset: 0, heightPercent: 0.8, widthPercent: 0.9});
	
// configure and append the legend to the graph

	var legLines = new Legend({
		xPos: "left", yPos: "top",
		labels: [
				{ content: "Ice Floe Stations"},
				{ content: "Mauna Loa"},
				{ content: "Aircraft (higher air temperature)"},
				{ content: "Aircraft (lower air temperature)"}
				],
		type: "line"
	},eventManager);
	
	lines.append(legLines);
	
	var marks = new MarkerGroup(
		{
		type: "x",
		marks: [maunaLoa[0], maunaLoa[11], maunaLoa[23]]
		}, eventManager);
		
	// write the markers onto the graph in the local coordinates, inside the 
	// data area.  These are designed to slop over the top, that's why the
	// graph is written to the bottom 80% of SVG area
	lines.append(marks);

	// Handle changes of the growth rate slider (one subscription per
	// event we listen to)
	
	eventManager.subscribe(legLines.selectedEventId,
						   handleHighlight);
	eventManager.subscribe(lines.selectedEventId,
						   handleHighlight);


	
/************************************************************************
* handleHighlight                                            *//**
*
* handleInputValueChanged is called from the event handler for one of
* the input widgets when the user changes its value. It updates the
* given matching input widget's value to match the new value and then
* updates the bar chart.
*
* @param eventDetails			These are the keyed values returned by 
*								the event, in this case, a selection
*								(click).
*************************************************************************/
	function handleHighlight(eventDetails)
	{
		//Handler needs to get written into each page, 
		//each widget will have it's own way of responding  
	
		lines.lite(eventDetails.selectKey);
		legLines.lite(eventDetails.selectKey);
		
	}

// Handle highlight clicks on the markers and table
	eventManager.subscribe(clickDates.selectedEventId,
						   handleSelectionChanged);
	eventManager.subscribe(marks.selectedEventId,
						   handleSelectionChanged);

 
//TEST: set the start highlight state of 0 index by calling the 
//handler with a hard-set index of 0.  This should result in the
//first label getting highlighted and the first callout being displayed.
	handleSelectionChanged({selectKey: '0'});
/************************************************************************
* handleSelectionChanged                                            *//**
*
* handleInputValueChanged is called from the event handler for one of
* the input widgets when the user changes its value. It updates the
* given matching input widget's value to match the new value and then
* updates the bar chart.
*
* @param eventDetails			These are the keyed values returned by 
*								the event, in this case, a selection
*								(click).
*************************************************************************/
	function handleSelectionChanged(eventDetails)
	{
		//Handler needs to get written into each page, 
		//each widget will have it's own way of responding  
		//LabelLite should be a method of Labels, once Labels
		//is written as a constructor
		clickDates.lite(eventDetails.selectKey);
		marks.lite(eventDetails.selectKey);
		
	}
	
	
	</script>
</body>
</html>
